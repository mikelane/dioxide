[tox]
env_list = py{311,312,313}, format, lint, type, mutate
isolated_build = true
min_version = 4.0

[testenv]
description = Run tests with pytest
deps =
    pytest>=8.0
commands =
    pytest {posargs:tests}

[testenv:cov]
description = Run tests with coverage
deps =
    pytest>=8.0
    pytest-cov>=4.1
commands =
    pytest --cov=dioxide --cov-report=term-missing --cov-report=html --cov-report=xml {posargs:tests}

[testenv:format]
description = Run code formatters
skip_install = true
deps =
    ruff>=0.1
    isort>=5.13
commands =
    ruff format python tests
    isort python tests

[testenv:lint]
description = Run linters
skip_install = true
deps =
    ruff>=0.1
    isort>=5.13
commands =
    ruff check python tests
    isort --check-only python tests

[testenv:type]
description = Run type checking
deps =
    mypy>=1.8
commands =
    mypy python tests

[testenv:mutate]
description = Run mutation testing
deps =
    pytest>=8.0
    mutmut>=2.4
commands =
    mutmut run

[testenv:all]
description = Run all quality checks
deps =
    pytest>=8.0
    pytest-cov>=4.1
    ruff>=0.1
    isort>=5.13
    mypy>=1.8
commands =
    ruff format python tests
    isort python tests
    ruff check python tests
    isort --check-only python tests
    mypy python tests
    pytest --cov=dioxide --cov-report=term-missing {posargs:tests}
